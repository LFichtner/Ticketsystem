var _URL = 'http://127.0.0.1:3000/';
var _collectionName = 'user';

var loginTest = function (callback) {
    var username = 'lasse';
    var password = 'pwd4lasse';
    var data = {
            methode: 'LOGIN',
            params: {
                userName: username,
                userPassword: password
            }
        };
    console.log(data);
    
    $.ajax({
        type:'post', 
        url: _URL + 'userManager',
        data: JSON.stringify(data),
//        crossDomain: true,
//        dataType: 'json',
        contentType: 'application/json',
        error: function (x, s, t){
            alert('jquery-ajax-error:' + s + '\n' + t);
        },
        success: function (result) {
            console.log(result);
            callback(result.data.sessionID);
        }
    });
};

var createTicketTest = function (sessionID) {
    var data = {
        params: {
            ticketTitle: 'ticketTest',
            ticketDescription: 'testDescription for ticket',
            ticketType: 'Verbesserung',
            ticketPriority: 1,
            ticketDueDate: '24.06.2016',
            ticketProjektID: "4d2e2ff8-f414-4dac-bcf9-218a66d1c",
            ticketUserID: "becb9e46-94a9-4d0b-8c3b-dff1497d24f5"
        },
        methode: 'create',
        sessionID: sessionID
    };
    
    $.ajax({
        type:'post', 
        url: _URL + 'ticketManager',
        data: JSON.stringify(data),
//        dataType: 'json',
        contentType: 'application/json',
        error: function (x, s, t){
            alert('jquery-ajax-error:' + s + '\n' + t);
        },
        success: function (result) {
            console.log(result);
        }
    });
};

var validateSessionTest = function (sessionid) {
    var sessionID = sessionid;
    
    $.ajax({
        type:'post', 
        url: _URL + 'updateSession',
        data: {
            sessionID: sessionID
        },
//        dataType: 'json',
        contentType: 'application/json',
        error: function (x, s, t){
            alert('jquery-ajax-error:' + s + '\n' + t);
        },
        success: function (result) {
            console.log(result);
        }
    });
};

var logoutTest = function (sessionid) {
    var sessionID = sessionid;
    
    $.ajax({
        type:'post', 
        url: _URL + 'userManager',
        data: {
            methode: 'logout', 
            sessionID: sessionID,
            params: {}
        },
        contentType: 'application/json',
        error: function (x, s, t){
            alert('jquery-ajax-error:' + s + '\n' + t);
        },
        success: function (result) {
            console.log(result);
        }
    });
};
$(document).ready(function () {
    loginTest(function (sessionID) {
        createTicketTest(sessionID);
    });
    
});
